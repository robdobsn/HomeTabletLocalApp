{
  "version": 3,
  "file": "calendar-server.js",
  "sourceRoot": "..\\..",
  "sources": [
    "www\\js\\calendar-server.coffee"
  ],
  "names": [],
  "mappings": ";AAAA;EAAM,GAAG,CAAC,kBAAV,MAAA,gBAAA;IACC,WAAa,IAAA,CAAA;MAAC,IAAC,CAAA;MACd,IAAC,CAAA,YAAD,GAAgB;MAChB,IAAC,CAAA,4BAAD,GAAgC;MAChC,IAAC,CAAA,yBAAD,GAA6B;MAC7B,IAAC,CAAA,0BAAD,GAA8B;MAC9B,IAAC,CAAA,8BAAD,GAAkC;MAClC,IAAC,CAAA,WAAD,GAAe;MACf,IAAC,CAAA,eAAD,GAAmB;AACnB;IARY;;IAUb,SAAW,CAAC,MAAD,CAAA;MACV,IAAG,kBAAH;QACC,IAAC,CAAA,WAAD,GAAe,MAAM,CAAC,IADvB;;MAEA,IAAG,sBAAH;QACC,IAAC,CAAA,eAAD,GAAmB,MAAM,CAAC,QAD3B;;MAEA,IAAC,CAAA,gBAAD,CAAA;IALU;;IAQX,gBAAkB,CAAA,CAAA;AACnB,UAAA;MAAE,IAAG,IAAC,CAAA,WAAD,KAAgB,EAAnB;AACC,eADD;;MAEA,WAAA,GAAc,IAAI,IAAJ,CAAA;MACd,OAAO,CAAC,GAAR,CAAY,kCAAA,GAAqC,WAAW,CAAC,YAAZ,CAAA,CAArC,GAAkE,QAAlE,GAA6E,IAAC,CAAA,WAA1F;MACA,CAAC,CAAC,IAAF,CAAO,IAAC,CAAA,WAAR,EACC;QAAA,IAAA,EAAM,KAAN;QACA,QAAA,EAAU,MADV;QAEA,WAAA,EAAa,IAFb;QAGA,OAAA,EAAS,CAAC,IAAD,EAAO,UAAP,EAAmB,KAAnB,CAAA,GAAA;AACZ,cAAA,QAAA,EAAA;UAAI,QAAA,GAAW,KAAK,CAAC;UACjB,QAAA,GAAW,CAAC,CAAC,SAAF,CAAY,QAAZ;UACX,IAAC,CAAA,YAAD,GAAgB;UAChB,IAAC,CAAA,8BAAD,GAAkC;UAClC,OAAO,CAAC,GAAR,CAAY,mCAAZ;QALQ,CAHT;QAUA,KAAA,EAAO,CAAC,KAAD,EAAQ,UAAR,EAAoB,WAApB,CAAA,GAAA;UAEN,OAAO,CAAC,GAAR,CAAY,kBAAA,GAAqB,8BAArB,GAAsD,UAAtD,GAAmE,OAAnE,GAA6E,IAAC,CAAA,WAA9E,GAA4F,UAA5F,GAAyG,WAArH;UAEA,GAAG,CAAC,YAAY,CAAC,QAAjB,CAA0B,QAA1B,EAAoC,oBAAA,GAAuB,UAAvB,GAAoC,OAApC,GAA8C,IAAC,CAAA,WAA/C,GAA6D,UAA7D,GAA0E,WAA9G;UACA,OAAO,CAAC,GAAR,CAAY,8BAAA,GAAiC,gCAAjC,GAAoE,UAApE,GAAiF,iBAAjF,GAAqG,WAAjH;UACA,IAAC,CAAA,8BAAD;UACA,UAAA,CAAW,CAAA,CAAA,GAAA;mBACV,IAAC,CAAA;UADS,CAAX,EAEE,CAAI,IAAC,CAAA,8BAAD,KAAmC,CAAtC,GAA6C,IAAC,CAAA,yBAAD,GAA6B,IAA1E,GAAoF,IAAC,CAAA,0BAAD,GAA8B,IAAnH,CAFF;QAPM;MAVP,CADD;IALiB;;IA6BlB,UAAY,CAAA,CAAA;AACX,aAAO,IAAC,CAAA;IADG;;IAGZ,aAAe,CAAA,CAAA;AACd,aAAO,IAAC,CAAA;IADM;;EAnDhB;AAAA",
  "sourcesContent": [
    "class App.CalendarManager\r\n\tconstructor: (@app) ->\r\n\t\t@calendarData = []\r\n\t\t@secsBetweenCalendarRefreshes = 60\r\n\t\t@firstRefreshAfterFailSecs = 10\r\n\t\t@nextRefreshesAfterFailSecs = 60\r\n\t\t@numRefreshFailuresSinceSuccess = 0\r\n\t\t@calendarUrl = \"\"\r\n\t\t@calendarNumDays = 31\r\n\t\treturn\r\n\r\n\tsetConfig: (config) ->\r\n\t\tif config.url?\r\n\t\t\t@calendarUrl = config.url\r\n\t\tif config.numDays?\r\n\t\t\t@calendarNumDays = config.numDays\r\n\t\t@requestCalUpdate()\r\n\t\treturn\r\n\r\n\trequestCalUpdate: ->\r\n\t\tif @calendarUrl is \"\" \r\n\t\t\treturn\r\n\t\tdateTimeNow = new Date()\r\n\t\tconsole.log(\"calendar-server ReqCalUpdate at \" + dateTimeNow.toTimeString() + \" from \" + @calendarUrl)\r\n\t\t$.ajax @calendarUrl,\r\n\t\t\ttype: \"GET\"\r\n\t\t\tdataType: \"text\"\r\n\t\t\tcrossDomain: true\r\n\t\t\tsuccess: (data, textStatus, jqXHR) =>\r\n\t\t\t\tjsonText = jqXHR.responseText\r\n\t\t\t\tjsonData = $.parseJSON(jsonText)\r\n\t\t\t\t@calendarData = jsonData\r\n\t\t\t\t@numRefreshFailuresSinceSuccess = 0\r\n\t\t\t\tconsole.log \"calendar-server Got calendar data\"\r\n\t\t\t\treturn\r\n\t\t\terror: (jqXHR, textStatus, errorThrown) =>\r\n\r\n\t\t\t\tconsole.log(\"calendar-server \" + \" CALENDAR AjaxFail Status = \" + textStatus + \" URL=\" + @calendarUrl + \" Error= \" + errorThrown);\r\n\r\n\t\t\t\tApp.LocalStorage.logEvent(\"CalLog\", \"AjaxFail Status = \" + textStatus + \" URL=\" + @calendarUrl + \" Error= \" + errorThrown)\r\n\t\t\t\tconsole.log \"calendar-server GetCalError \" + \"ReqCalAjaxFailed TextStatus = \" + textStatus + \" ErrorThrown = \" + errorThrown\r\n\t\t\t\t@numRefreshFailuresSinceSuccess++\r\n\t\t\t\tsetTimeout =>\r\n\t\t\t\t\t@requestCalUpdate\r\n\t\t\t\t, (if @numRefreshFailuresSinceSuccess is 1 then @firstRefreshAfterFailSecs * 1000 else @nextRefreshesAfterFailSecs * 1000)\r\n\t\t\t\treturn\r\n\t\treturn\r\n\r\n\tgetCalData: ->\r\n\t\treturn @calendarData\r\n\r\n\tgetCalNumDays: ->\r\n\t\treturn @calendarNumDays\r\n"
  ]
}